#!/usr/bin/env node
const program = require('commander')
const chalk = require('chalk')
const child_process = require('child_process')
const download  = require('download-git-repo')
const pkg = require('../package.json')
program.version(pkg.version)


program
  .command('b <pathName>')
  .alias('base')
  .option('--p', '创建pack架构')
  .description(chalk.yellow('创建一个基础架构，不带任何业务信息'))
  .action(function (pathName, option) {
    const path = option.p ? `https://github.com/zasqw2222/abcFountByPack.git` : `https://github.com/zasqw2222/abcftFront.git`
    child_process.exec(`git clone ${path} ${pathName}`, (error, stdout, stderr) => {
      if (error) {
        console.error(`错误: ${error}`);
        return;
      }

      child_process.exec(`rm -rf ${pathName}/.git/`, (error, stdout, stderr) => {
        if (error) {
          console.error(`错误: ${error}`);
          return;
        }
        console.log(`项目文件下载完毕。
          请运行 cd ${pathName}
          处理 git仓库信息，然后 
          npm install
        `);
      })

    })
  })
program
  .command('*')
  .description(chalk.yellow('捕获错误'))
  .action(function () {
    console.log(chalk.magenta(`
                     输入命令行不正确
                     输入 create-abcft-app --help、-h
                     获取帮助`));
  })

program.parse(process.argv)